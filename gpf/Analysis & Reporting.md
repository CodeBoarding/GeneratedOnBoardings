## Analysis & Reporting Component Overview

The `Analysis & Reporting` component provides the necessary tools and libraries for performing biological analyses, specifically enrichment analysis and gene profiling, and for managing collections of gene sets used in these analyses.

```mermaid
componentDiagram
    [Genomic Resource Repository] --> [Gene Set Management] : provides resources to
    [Genomic Resource Repository] --> [Enrichment Tooling] : provides resources to
    [Gene Set Management] --> [Enrichment Tooling] : provides gene sets to
    [Gene Set Management] --> [Gene Profile Management] : provides configuration to
    [Genotype Data] --> [Enrichment Tooling] : is processed by
    [Enrichment Tooling] --> [Analysis Results] : generates
    [Gene Profile Management] --> [Gene Profile Data] : stores/retrieves
```

### Component Descriptions

#### Enrichment Tooling
-   **Description**: This component provides the core logic for performing enrichment analysis on genotype data. It manages enrichment configurations, selects appropriate background and counting models, calculates enrichment tests, and can utilize a caching mechanism for performance.
-   **Relationship to Neighbors**: It receives genotype data for analysis. It uses the `Genomic Resource Repository` to load background models and potentially other resources. It relies on `Gene Set Management` to obtain the gene sets against which enrichment is tested. It produces analysis results.
-   **Relevant Source Files**: `dae.enrichment_tool.enrichment_helper.EnrichmentHelper`, `dae.enrichment_tool.base_enrichment_background.BaseEnrichmentBackground`, `dae.enrichment_tool.event_counters.CounterBase`, `dae.enrichment_tool.genotype_helper.GenotypeHelper`, `dae.enrichment_tool.enrichment_cache_builder`, `dae.enrichment_tool.enrichment_builder.BaseEnrichmentBuilder`

#### Gene Profile Management
-   **Description**: This component is responsible for storing, retrieving, and querying gene profile statistics. It uses a DuckDB database to persist the gene profile data and provides methods for accessing individual gene profiles or querying subsets based on various criteria. It also includes functionality for building and writing the gene profile database.
-   **Relationship to Neighbors**: It uses configuration information, potentially including gene set categories from `Gene Set Management`, to structure and manage the gene profile database. It stores and retrieves gene profile data.
-   **Relevant Source Files**: `dae.gene_profile.db.GeneProfileDB`, `dae.gene_profile.db.GeneProfileDBWriter`, `dae.gene_profile.statistic.GPStatistic`, `dae.gene_profile.generate_gene_profile`, `dae.gene_profile.convert_gene_profile_to_duckdb`

#### Gene Set Management
-   **Description**: This component handles the organization and access of gene sets. It manages collections of gene sets loaded from genomic resources and provides methods to retrieve specific gene sets or list available collections and sets. It supports different file formats for gene set collections.
-   **Relationship to Neighbors**: It loads gene set data from `Genomic Resource Repository`. It provides gene sets to `Enrichment Tooling` for analysis and provides configuration information related to gene sets to `Gene Profile Management`.
-   **Relevant Source Files**: `dae.gene_sets.gene_sets_db.GeneSetsDb`, `dae.gene_sets.gene_sets_db.GeneSetCollection`, `dae.gene_sets.gene_sets_db.GeneSet`, `dae.gene_sets.gene_sets_db.build_gene_set_collection_from_resource`, `dae.gene_sets.gene_sets_db.build_gene_set_collection_from_resource_id`, `dae.gene_sets.gene_sets_db.build_gene_set_collection_from_file`, `dae.gene_sets.implementations.gene_sets_impl.GeneSetCollectionImpl`

#### Genotype Data
-   **Description**: Represents the input genetic variation data used for analysis.
-   **Relationship to Neighbors**: Provides the primary data source for `Enrichment Tooling`.
-   **Relevant Source Files**: (Represented by `dae.studies.study.GenotypeData`)

#### Genomic Resource Repository
-   **Description**: A repository managing various genomic resources, including gene sets and enrichment background models.
-   **Relationship to Neighbors**: Provides necessary resources, such as gene set collections and enrichment backgrounds, to `Gene Set Management` and `Enrichment Tooling`.
-   **Relevant Source Files**: (Represented by `dae.genomic_resources.repository.GenomicResourceRepo`)

#### Analysis Results
-   **Description**: The output generated by the enrichment analysis process.
-   **Relationship to Neighbors**: Receives results from `Enrichment Tooling`.
-   **Relevant Source Files**: (Output data structure, e.g., `dae.enrichment_tool.base_enrichment_background.EnrichmentResult`)

#### Gene Profile Data
-   **Description**: The stored gene profile statistics.
-   **Relationship to Neighbors**: Stored and retrieved by `Gene Profile Management`.
-   **Relevant Source Files**: (Data stored in the DuckDB database, represented by `dae.gene_profile.statistic.GPStatistic`)
