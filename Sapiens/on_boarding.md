```mermaid
graph LR
    Model_and_Tokenizer_Management["Model and Tokenizer Management"]
    Core_Prediction_Engine["Core Prediction Engine"]
    Prediction_Result_Processors["Prediction Result Processors"]
    Core_Prediction_Engine -- "loads resources from" --> Model_and_Tokenizer_Management
    Prediction_Result_Processors -- "leverages" --> Core_Prediction_Engine
    click Model_and_Tokenizer_Management href "https://github.com/CodeBoarding/GeneratedOnBoardings/blob/main/Sapiens/Model and Tokenizer Management.md" "Details"
    click Core_Prediction_Engine href "https://github.com/CodeBoarding/GeneratedOnBoardings/blob/main/Sapiens/Core Prediction Engine.md" "Details"
    click Prediction_Result_Processors href "https://github.com/CodeBoarding/GeneratedOnBoardings/blob/main/Sapiens/Prediction Result Processors.md" "Details"
```
[![CodeBoarding](https://img.shields.io/badge/Generated%20by-CodeBoarding-9cf?style=flat-square)](https://github.com/CodeBoarding/GeneratedOnBoardings)[![Demo](https://img.shields.io/badge/Try%20our-Demo-blue?style=flat-square)](https://www.codeboarding.org/demo)[![Contact](https://img.shields.io/badge/Contact%20us%20-%20contact@codeboarding.org-lightgrey?style=flat-square)](mailto:contact@codeboarding.org)

## Component Details

This architecture describes the core prediction functionality of the Sapiens project. It outlines the flow from loading and managing pre-trained models and tokenizers, through the execution of the core prediction logic, to the subsequent processing and interpretation of the prediction results for various downstream tasks.

### Model and Tokenizer Management
Manages the loading and caching of pre-trained language models (RobertaForMaskedLM) and their corresponding tokenizers (RobertaTokenizer) to optimize performance by avoiding redundant loading. It ensures that the necessary resources are available for the core prediction engine.


**Related Classes/Methods**:

- <a href="https://github.com/Merck/Sapiens/blob/master/sapiens/predict.py#L11-L14" target="_blank" rel="noopener noreferrer">`Sapiens.sapiens.predict.load_cached_model` (11:14)</a>
- <a href="https://github.com/Merck/Sapiens/blob/master/sapiens/predict.py#L17-L20" target="_blank" rel="noopener noreferrer">`Sapiens.sapiens.predict.load_cached_tokenizer` (17:20)</a>


### Core Prediction Engine
Performs the fundamental prediction of Sapiens residue scores for a given sequence and chain type. It utilizes the cached models and tokenizers to generate raw prediction outputs (logits or probabilities) and can also return hidden states as embeddings.


**Related Classes/Methods**:

- <a href="https://github.com/Merck/Sapiens/blob/master/sapiens/predict.py#L23-L59" target="_blank" rel="noopener noreferrer">`Sapiens.sapiens.predict:predict_scores` (23:59)</a>


### Prediction Result Processors
Provides various utility functions to process and interpret the raw prediction scores and embeddings generated by the Core Prediction Engine. This includes determining the best scoring sequence, applying masking, and extracting different types of embeddings (residue and sequence).


**Related Classes/Methods**:

- <a href="https://github.com/Merck/Sapiens/blob/master/sapiens/predict.py#L62-L64" target="_blank" rel="noopener noreferrer">`Sapiens.sapiens.predict:predict_best_score` (62:64)</a>
- <a href="https://github.com/Merck/Sapiens/blob/master/sapiens/predict.py#L67-L69" target="_blank" rel="noopener noreferrer">`Sapiens.sapiens.predict:predict_masked` (67:69)</a>
- <a href="https://github.com/Merck/Sapiens/blob/master/sapiens/predict.py#L72-L74" target="_blank" rel="noopener noreferrer">`Sapiens.sapiens.predict:predict_residue_embedding` (72:74)</a>
- <a href="https://github.com/Merck/Sapiens/blob/master/sapiens/predict.py#L77-L78" target="_blank" rel="noopener noreferrer">`Sapiens.sapiens.predict:predict_sequence_embedding` (77:78)</a>




### [FAQ](https://github.com/CodeBoarding/GeneratedOnBoardings/tree/main?tab=readme-ov-file#faq)